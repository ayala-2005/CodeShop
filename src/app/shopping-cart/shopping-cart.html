<div class="products-container">
  <h2 class="page-title">העגלה שלי</h2>

  <div class="cart-content">
    <!-- Loading -->
    <div *ngIf="loading()" class="loading-state">
      <div class="spinner"></div>
      <p>טוען את העגלה...</p>
    </div>

    <!-- Empty -->
    <div *ngIf="!loading() && list().length === 0" class="empty-state">
      <p>העגלה ריקה</p>
      <p style="font-size: 0.9rem; margin-top: 10px; color: #999;">הוסף מוצרים כדי להתחיל</p>
    </div>

    <!-- Cart Products -->
    <div *ngIf="!loading() && list().length > 0" class="cart-layout">
      <!-- Cart Items -->
      <div class="cart-items">
        <div *ngFor="let item of list()" class="cart-card">
          <div class="cart-card-content">
            <!-- Product Icon/Image -->
            <div class="cart-product-visual">
              <div *ngIf="item.product?.image; else defaultIcon" class="product-image-wrapper">
                <img [src]="item.product?.image" [alt]="item.product?.productName" class="product-image">
              </div>
              <ng-template #defaultIcon>
                <div class="product-icon">
                  <span class="code-symbol">&lt;/&gt;</span>
                </div>
              </ng-template>
            </div>

            <!-- Product Details -->
            <div class="cart-product-details">
              <h3 class="product-name">{{ item.product?.productName }}</h3>

              <div class="product-meta">
                <span *ngIf="item.product?.categoryName" class="meta-badge">
                  {{ item.product?.categoryName }}
                </span>
                <span *ngIf="item.product?.companyName" class="meta-badge">
                  {{ item.product?.companyName }}
                </span>
              </div>

              <p *ngIf="item.product?.description" class="product-description">
                {{ item.product?.description }}
              </p>
            </div>

            <!-- Price and Actions -->
            <div class="cart-product-actions">
              <p class="product-price">₪{{ item.product?.price }}</p>
              <button class="remove-button" (click)="removeFromCart(item.productId)">
                הסר מהעגלה
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Cart Summary -->
      <div class="cart-summary">
        <h3>סיכום הזמנה</h3>

        <div class="summary-row">
          <span>מספר פריטים:</span>
          <strong>{{ list().length }}</strong>
        </div>

        <div class="summary-row total-row">
          <span>סה"כ לתשלום:</span>
          <strong class="total-price">₪{{ totalPrice() }}</strong>
        </div>

        <button class="checkout-button" (click)="goToCheckout()">
          המשך לתשלום
        </button>
        <div *ngIf="notLoggedInMessage()" class="login-warning">
          כדי לבצע תשלום יש להתחבר למערכת
        </div>
        <button class="continue-shopping-button" (click)="continueShopping()">
          המשך בקניות
        </button>
      </div>
    </div>
  </div>
</div>